## 3) `carrental.service` — 业务逻辑层（Service）

**一句话定位**：封装业务流程与事务，调用 DAO 完成业务用例（租车/归还/登录/报表生成等）。

**职责**

* 实现完整业务用例（比如 `checkout()`、`returnCar()`），并在需要时使用 DB 事务（begin/commit/rollback）
* 做输入校验（部分）、调用 DAO，并处理异常/回滚
* 将复杂逻辑从 UI 层抽离，使 UI 只负责展示/事件触发

**常见类 / 方法**

* `UserService.login(username, password)`：校验、hash 验证、记录 lastLogin
* `RentalService.checkout(carId, customerId, staffId, start, expectedEnd)`：事务性操作（检查状态->插入租赁->更新车辆状态）
* `RentalService.returnCar(rentalId, actualEnd)`：计算费用、更新 rental、更新车辆状态
* `ReportService.generateMonthlyRevenue(year, month)`

**注意事项**

* 关键多表更新必须放事务（`conn.setAutoCommit(false)` + try/catch rollback）
* Service 接受/返回 model 对象，或简单 DTO
* 业务异常要有自定义异常类型便于 UI 显示友好错误

**package-info.java 模板**

```java
/**
 * carrental.service
 *
 * 说明：
 * Service 层封装系统业务流程（use-cases）。这里负责组合 DAO 的原子操作并控制事务，
 * 做业务级校验，返回业务结果或抛出业务异常。
 *
 * 设计要点：
 * - 在需要时显式管理事务（begin/commit/rollback）
 * - 不在此层做 UI 显示或低级 JDBC 操作细节
 * - 定义清晰的业务异常以供 UI 捕获并提示用户
 *
 * 常见类：
 * - UserService, CarService, CustomerService, RentalService, ReportService
 */
package carrental.service;
```